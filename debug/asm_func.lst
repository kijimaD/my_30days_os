GAS LISTING asm_func.s 			page 1


   1              	.arch i486
   2              	.text
   3              	
   4              	.global io_hlt, io_cli, io_sti, io_stihlt
   5              	.global io_in8, io_in16, io_in32
   6              	.global io_out8, io_out16, io_out32
   7              	.global io_load_eflags, io_store_eflags
   8              	.global load_gdtr, load_idtr
   9              	
  10              	# void io_hlt(void)
  11              	io_hlt:
  12 0000 F4       	        hlt
  13 0001 C3       	        ret
  14              	
  15              	# void io_cli(void)
  16              	io_cli:
  17 0002 FA       	        cli
  18 0003 C3       	        ret
  19              	
  20              	# void io_sti(void)
  21              	io_sti:
  22 0004 FB       	        sti
  23 0005 C3       	        ret
  24              	
  25              	# void io_stihlt(void)
  26              	io_stihlt:
  27 0006 FB       	        sti
  28 0007 F4       	        hlt
  29 0008 C3       	        ret
  30              	
  31              	# int io_in8(int port)
  32              	io_in8:
  33 0009 8B542404 	        movl 4(%esp), %edx
  34 000d B8000000 	        movl $0, %eax
  34      00
  35 0012 EC       	        inb %dx, %al
  36 0013 C3       	        ret
  37              	
  38              	# int io_in16(int port)
  39              	io_in16:
  40 0014 8B542404 	        movl 4(%esp), %edx
  41 0018 B8000000 	        movl $0, %eax
  41      00
  42 001d 66ED     	        inw %dx, %ax
  43 001f C3       	        ret
  44              	
  45              	# int io_in32(int port)
  46              	io_in32:
  47 0020 8B542404 	        movl 4(%esp), %edx
  48 0024 ED       	        inl %dx, %eax
  49 0025 C3       	        ret
  50              	
  51              	# void io_out8(int addr, int data)
  52              	# æŒ‡å®šã—ãŸè£…ç½®ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ã‚Šã¤ã‘ã‚‹
  53              	# Cè¨€èªã‹ã‚‰å‘¼ã³å‡ºã™å ´åˆã«ä½¿ãˆã‚‹ã®ã¯EAX, ECX, EDXã®3ã¤ã ã‘
  54              	io_out8:
  55              	        # ESP+4ã«addrãŒå…¥ã£ã¦ã„ã‚‹ã®ã§EDXã«èª­ã¿è¾¼ã‚€ã€‚ç•ªåœ°ãªã®ã§4ãƒã‚¤ãƒˆå¿…è¦
GAS LISTING asm_func.s 			page 2


  56 0026 8B542404 	        movl 4(%esp), %edx
  57              	        # ESP+8ã«dataãŒå…¥ã£ã¦ã„ã‚‹ã®ã§ALã«èª­ã¿è¾¼ã‚€
  58 002a 8A442408 	        movb 8(%esp), %al
  59 002e EE       	        outb %al, %dx
  60 002f C3       	        ret
  61              	
  62              	# void io_out16
  63              	io_out16:
  64 0030 8B542404 	        movl 4(%esp), %edx
  65 0034 8B442408 	        movl 8(%esp), %eax
  66 0038 66EF     	        outw %ax, (%dx)
  67 003a C3       	        ret
  68              	
  69              	# void io_out32
  70              	io_out32:
  71 003b 8B542404 	        movl 4(%esp), %edx
  72 003f 8B442408 	        movl 8(%esp), %eax
  73 0043 EF       	        outl %eax, %dx
  74 0044 C3       	        ret
  75              	
  76              	# int io_load_eflags(void)
  77              	io_load_eflags:
  78 0045 9C       	        pushf
  79 0046 58       	        pop %eax
  80 0047 C3       	        ret
  81              	
  82              	# int io_store_eflags(void)
  83              	io_store_eflags:
  84 0048 8B442404 	        movl 4(%esp), %eax
  85 004c 50       	        push %eax
  86 004d 9D       	        popf
  87 004e C3       	        ret
  88              	
  89              	# GDTã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨ã‚µã‚¤ã‚ºã‚’CPUã«çŸ¥ã‚‰ã›ã‚‹
  90              	# GDTRãƒ¬ã‚¸ã‚¹ã‚¿ã‚’lgtrå‘½ä»¤ã‚’ä½¿ã£ã¦ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§ã€GDTã‚’ã‚·ã‚¹ãƒ†ãƒ ã§æœ‰åŠ¹ã
  91              	# GDTRã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã¯ã€æœ€åˆã®2ãƒã‚¤ãƒˆãŒlimitã€æ¬¡ã®4ãƒã‚¤ãƒˆãŒbase addressã
  92              	# void load_gdtr(int limit, int addr)
  93              	load_gdtr:
  94 004f 668B4424 	        mov 4(%esp), %ax # limit
  94      04
  95 0054 66894424 	        mov %ax, 6(%esp)
  95      06
  96 0059 0F015424 	        lgdt 6(%esp)
  96      06
  97 005e C3       	        ret
  98              	
  99              	# void load_idtr(int limit, int addr)
 100              	load_idtr:
 101 005f 668B4424 	        mov 4(%esp), %ax # limit
 101      04
 102 0064 66894424 	        mov %ax, 6(%esp)
 102      06
 103 0069 0F015C24 	        lidt 6(%esp)
 103      06
 104 006e C3       	        ret
GAS LISTING asm_func.s 			page 3


DEFINED SYMBOLS
          asm_func.s:11     .text:0000000000000000 io_hlt
          asm_func.s:16     .text:0000000000000002 io_cli
          asm_func.s:21     .text:0000000000000004 io_sti
          asm_func.s:26     .text:0000000000000006 io_stihlt
          asm_func.s:32     .text:0000000000000009 io_in8
          asm_func.s:39     .text:0000000000000014 io_in16
          asm_func.s:46     .text:0000000000000020 io_in32
          asm_func.s:54     .text:0000000000000026 io_out8
          asm_func.s:63     .text:0000000000000030 io_out16
          asm_func.s:70     .text:000000000000003b io_out32
          asm_func.s:77     .text:0000000000000045 io_load_eflags
          asm_func.s:83     .text:0000000000000048 io_store_eflags
          asm_func.s:93     .text:000000000000004f load_gdtr
          asm_func.s:100    .text:000000000000005f load_idtr

NO UNDEFINED SYMBOLS
